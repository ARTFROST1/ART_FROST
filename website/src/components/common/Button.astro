---
/**
 * Button Component
 * Reusable button with multiple variants and sizes
 * Supports both button and anchor (link) elements
 *
 * @example
 * <Button variant="primary" size="md">Click me</Button>
 * <Button href="/about" variant="secondary">Learn more</Button>
 */

import { cn } from '@lib/utils';

interface Props {
  /** Button variant */
  variant?: 'primary' | 'secondary' | 'ghost' | 'outline';
  /** Button size */
  size?: 'sm' | 'md' | 'lg';
  /** URL for anchor element */
  href?: string;
  /** Disabled state */
  disabled?: boolean;
  /** Full width button */
  fullWidth?: boolean;
  /** Button type (for native button) */
  type?: 'button' | 'submit' | 'reset';
  /** Additional CSS classes */
  class?: string;
  /** Icon only button (adds equal padding) */
  iconOnly?: boolean;
  /** External link */
  external?: boolean;
}

const {
  variant = 'primary',
  size = 'md',
  href,
  disabled = false,
  fullWidth = false,
  type = 'button',
  class: className,
  iconOnly = false,
  external = false,
} = Astro.props;

// Base styles
const baseStyles = cn(
  'relative inline-flex items-center justify-center gap-2',
  'whitespace-nowrap font-medium leading-[1.1]',
  'rounded-xl',
  'transition-[transform,box-shadow,background-color,border-color,color] duration-200 ease-out',
  'focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/40 focus:ring-offset-2 focus:ring-offset-[var(--color-bg-primary)]',
  'disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:hover:shadow-none'
);

// Variant styles
const variantStyles = {
  primary: cn(
    'text-white font-semibold',
    'border border-white/10',
    'bg-[linear-gradient(135deg,rgba(52,184,99,0.55)_0%,rgba(42,153,80,0.35)_45%,rgba(31,122,61,0.25)_100%)]',
    'backdrop-blur-xl',
    'shadow-[0_0_30px_-10px_rgba(52,184,99,0.65),0_10px_25px_-12px_rgba(0,0,0,0.6),inset_0_1px_0_rgba(255,255,255,0.12)]',
    'hover:scale-[1.02] hover:border-white/15 hover:shadow-[0_0_45px_-10px_rgba(52,184,99,0.8),0_16px_30px_-14px_rgba(0,0,0,0.65),inset_0_1px_0_rgba(255,255,255,0.14)]',
    'active:scale-[0.99]'
  ),
  secondary: cn(
    'text-[var(--color-text-heading)]',
    'border border-[var(--color-border-glass-strong)]',
    'bg-[var(--color-bg-glass)] backdrop-blur-xl',
    'shadow-[0_10px_25px_-14px_rgba(0,0,0,0.6),inset_0_1px_0_rgba(255,255,255,0.06)]',
    'hover:bg-[var(--color-bg-glass-strong)] hover:scale-[1.02]',
    '[html[data-theme="light"]_&]:hover:bg-black/8',
    '[html[data-theme="light"]_&]:shadow-[0_8px_20px_-12px_rgba(0,0,0,0.15),inset_0_1px_0_rgba(0,0,0,0.03)]',
    'active:scale-[0.99]'
  ),
  ghost: cn(
    'bg-transparent',
    'text-[var(--color-text-body)]',
    'hover:text-[var(--color-text-heading)]',
    'hover:bg-white/5',
    '[html[data-theme="light"]_&]:hover:bg-black/5',
    'active:bg-white/7',
    '[html[data-theme="light"]_&]:active:bg-black/8'
  ),
  outline: cn(
    'text-[var(--color-text-heading)]',
    'border border-[var(--color-border-glass-strong)]',
    'bg-transparent backdrop-blur-xl',
    'shadow-[0_10px_25px_-14px_rgba(0,0,0,0.55),inset_0_1px_0_rgba(255,255,255,0.04)]',
    'hover:bg-white/5 hover:scale-[1.02]',
    '[html[data-theme="light"]_&]:hover:bg-black/5',
    '[html[data-theme="light"]_&]:shadow-[0_8px_20px_-12px_rgba(0,0,0,0.12),inset_0_1px_0_rgba(0,0,0,0.02)]',
    'active:bg-white/7 active:scale-[0.99]',
    '[html[data-theme="light"]_&]:active:bg-black/8'
  ),
};

// Size styles - ТОЛЬКО padding, без фиксированной высоты!
const sizeStyles = {
  sm: iconOnly ? 'p-3 text-sm' : 'px-5 py-2.5 text-sm',
  md: iconOnly ? 'p-3.5 text-sm' : 'px-7 py-3 text-sm',
  lg: iconOnly ? 'p-4 text-base' : 'px-10 py-4 text-base',
};

// Combine all styles
const combinedStyles = cn(
  baseStyles,
  variantStyles[variant],
  sizeStyles[size],
  fullWidth && 'w-full',
  className
);

// External link attributes
const externalAttrs = external
  ? { target: '_blank', rel: 'noopener noreferrer' }
  : {};
---

{
  href && !disabled ? (
    <a href={href} class={combinedStyles} {...externalAttrs}>
      <slot />
    </a>
  ) : (
    <button
      type={type}
      disabled={disabled}
      class={combinedStyles}
      aria-disabled={disabled}
    >
      <slot />
    </button>
  )
}
